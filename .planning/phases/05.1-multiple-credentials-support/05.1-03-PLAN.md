---
phase: 05.1-multiple-credentials-support
plan: 03
type: execute
wave: 2
depends_on: ["05.1-01"]
files_modified:
  - apps/orchestrator_3_stream/frontend/src/types/account.ts
  - apps/orchestrator_3_stream/frontend/src/components/AccountManagerDialog.vue
  - apps/orchestrator_3_stream/frontend/src/components/AccountSelector.vue
autonomous: true

must_haves:
  truths:
    - "Frontend TypeScript types include nickname field"
    - "Add credential form shows nickname input field"
    - "Credential selector displays nickname instead of date"
  artifacts:
    - path: "apps/orchestrator_3_stream/frontend/src/types/account.ts"
      provides: "TypeScript types with nickname field"
      contains: "nickname?: string"
    - path: "apps/orchestrator_3_stream/frontend/src/components/AccountManagerDialog.vue"
      provides: "Form with nickname input"
      contains: "nickname"
    - path: "apps/orchestrator_3_stream/frontend/src/components/AccountSelector.vue"
      provides: "Selector showing nickname labels"
      contains: "nickname"
  key_links:
    - from: "AccountManagerDialog.vue"
      to: "account.ts"
      via: "CredentialInput type"
      pattern: "CredentialInput"
---

<objective>
Update frontend types and components to support nickname field

Purpose: Allow users to enter a nickname when adding credentials and see nicknames in the credential selector for easy identification
Output: Updated TypeScript types, form with nickname input, selector showing nicknames
</objective>

<execution_context>
@/Users/muzz/.claude/get-shit-done/workflows/execute-plan.md
@/Users/muzz/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05.1-multiple-credentials-support/05.1-RESEARCH.md
@apps/orchestrator_3_stream/frontend/src/types/account.ts
@apps/orchestrator_3_stream/frontend/src/components/AccountManagerDialog.vue
@apps/orchestrator_3_stream/frontend/src/components/AccountSelector.vue
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add Nickname to TypeScript Types</name>
  <files>apps/orchestrator_3_stream/frontend/src/types/account.ts</files>
  <action>
    1. Add nickname field to CredentialResponse interface (after credential_type, around line 16):
       ```typescript
       /** User-friendly label for the credential */
       nickname?: string | null
       ```

    2. Add nickname field to CredentialInput interface (after secret_key, around line 63):
       ```typescript
       /** Optional user-friendly label (defaults to credential_type on backend) */
       nickname?: string
       ```

    3. Add helper function at end of file (before exports):
       ```typescript
       /**
        * Get display label for credential.
        * Uses nickname if available, falls back to credential_type.
        */
       export function getCredentialDisplayLabel(cred: CredentialResponse): string {
         return cred.nickname || cred.credential_type || 'Unnamed Credential'
       }
       ```
  </action>
  <verify>
    Run: `grep -n "nickname" apps/orchestrator_3_stream/frontend/src/types/account.ts`
    - Shows nickname in CredentialResponse
    - Shows nickname in CredentialInput
    - Shows getCredentialDisplayLabel helper function
  </verify>
  <done>
    TypeScript types include nickname field and helper function
  </done>
</task>

<task type="auto">
  <name>Task 2: Add Nickname Input to AccountManagerDialog</name>
  <files>apps/orchestrator_3_stream/frontend/src/components/AccountManagerDialog.vue</files>
  <action>
    1. Add nickname field to formData (around line 96-100):
       ```typescript
       const formData = ref<CredentialInput>({
         credential_type: 'alpaca',
         api_key: '',
         secret_key: '',
         nickname: ''  // NEW
       })
       ```

    2. Add nickname form item in template (after Account Type, before API Key, around line 35):
       ```vue
       <el-form-item label="Nickname" prop="nickname">
         <el-input
           v-model="formData.nickname"
           placeholder="Paper Account 1"
           maxlength="100"
         />
         <template #extra>
           <span class="input-hint">Optional. Helps identify this account.</span>
         </template>
       </el-form-item>
       ```

    3. Update resetForm function to include nickname (around line 147-154):
       ```typescript
       function resetForm() {
         formData.value = {
           credential_type: 'alpaca',
           api_key: '',
           secret_key: '',
           nickname: ''  // NEW
         }
         formRef.value?.clearValidate()
       }
       ```

    4. Add CSS for input-hint (in style section):
       ```css
       .input-hint {
         color: var(--text-muted);
         font-size: 0.75rem;
         margin-top: 4px;
       }
       ```
  </action>
  <verify>
    Run: `grep -n "nickname" apps/orchestrator_3_stream/frontend/src/components/AccountManagerDialog.vue`
    - Shows nickname in formData
    - Shows nickname form input in template
  </verify>
  <done>
    Add credential form includes nickname input field
  </done>
</task>

<task type="auto">
  <name>Task 3: Update AccountSelector to Display Nicknames</name>
  <files>apps/orchestrator_3_stream/frontend/src/components/AccountSelector.vue</files>
  <action>
    1. Import getCredentialDisplayLabel helper (around line 31):
       ```typescript
       import { getCredentialDisplayLabel } from '@/types/account'
       ```

    2. Update formatLabel function to use nickname (around line 47-56):
       ```typescript
       // Format label for dropdown
       function formatLabel(cred: CredentialResponse): string {
         // Use nickname if available, otherwise show type + date
         if (cred.nickname && cred.nickname !== cred.credential_type) {
           return cred.nickname
         }
         // Fallback to type + date format
         const type = cred.credential_type.charAt(0).toUpperCase() + cred.credential_type.slice(1)
         const date = new Date(cred.created_at)
         const formattedDate = date.toLocaleDateString('en-US', {
           month: 'short',
           day: 'numeric',
           year: 'numeric'
         })
         return `${type} - ${formattedDate}`
       }
       ```

    Note: Keep the existing getCredentialDisplayLabel import from types if you added it there.
    Alternative simpler version using the helper:
    ```typescript
    function formatLabel(cred: CredentialResponse): string {
      return getCredentialDisplayLabel(cred)
    }
    ```
  </action>
  <verify>
    Run: `grep -n "nickname" apps/orchestrator_3_stream/frontend/src/components/AccountSelector.vue`
    - Shows nickname usage in formatLabel function
  </verify>
  <done>
    Credential selector displays nickname labels for easy identification
  </done>
</task>

</tasks>

<verification>
1. TypeScript types compile without errors: `cd apps/orchestrator_3_stream/frontend && npm run type-check`
2. CredentialResponse interface has nickname field
3. CredentialInput interface has nickname field
4. AccountManagerDialog has nickname form field
5. AccountSelector formatLabel uses nickname
</verification>

<success_criteria>
- Frontend compiles without TypeScript errors
- Nickname field visible in add credential dialog
- Selector shows nicknames for credentials that have them
</success_criteria>

<output>
After completion, create `.planning/phases/05.1-multiple-credentials-support/05.1-03-SUMMARY.md`
</output>
