---
phase: 05-account-display
plan: 03
type: execute
wave: 3
depends_on: ["05-02"]
files_modified:
  - apps/orchestrator_3_stream/frontend/src/components/AccountDataDisplay.vue
  - apps/orchestrator_3_stream/frontend/src/components/AppHeader.vue
autonomous: false

must_haves:
  truths:
    - "User can see account type (paper/live) badge"
    - "User can see balance, equity, and buying power"
    - "Paper accounts show warning-colored badge"
    - "Live accounts show danger-colored badge"
    - "Loading skeleton shown while fetching"
  artifacts:
    - path: "apps/orchestrator_3_stream/frontend/src/components/AccountDataDisplay.vue"
      provides: "Account metrics display component"
      min_lines: 80
    - path: "apps/orchestrator_3_stream/frontend/src/components/AppHeader.vue"
      provides: "Header with account display integration"
      contains: "AccountDataDisplay"
  key_links:
    - from: "components/AccountDataDisplay.vue"
      to: "stores/accountStore.ts"
      via: "useAccountStore for reactive data"
      pattern: "useAccountStore"
    - from: "components/AppHeader.vue"
      to: "components/AccountDataDisplay.vue"
      via: "Component import and usage"
      pattern: "AccountDataDisplay"
---

<objective>
Create AccountDataDisplay.vue component and integrate it into AppHeader.

Purpose: Users need to see their active account's type, balance, equity, and buying power prominently in the UI. Paper vs live accounts must be visually distinguishable.

Output: AccountDataDisplay.vue component showing account metrics with Element Plus components (Card, Badge, Statistic, Skeleton), integrated into AppHeader for prominent display.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-account-display/05-RESEARCH.md
@.planning/phases/05-account-display/05-02-SUMMARY.md
@apps/orchestrator_3_stream/frontend/src/stores/accountStore.ts
@apps/orchestrator_3_stream/frontend/src/components/AppHeader.vue
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create AccountDataDisplay.vue component</name>
  <files>apps/orchestrator_3_stream/frontend/src/components/AccountDataDisplay.vue</files>
  <action>
Create new component using Element Plus components (Card, Badge, Statistic, Skeleton):

```vue
<template>
  <el-card class="account-data-display" shadow="hover" :body-style="{ padding: '12px 16px' }">
    <!-- Header with account type badge -->
    <template #header>
      <div class="card-header">
        <span class="header-title">Active Account</span>
        <el-badge
          v-if="accountData && !accountDataLoading"
          :value="accountData.account_type.toUpperCase()"
          :type="accountTypeBadgeType"
          class="account-type-badge"
        />
      </div>
    </template>

    <!-- Loading skeleton -->
    <el-skeleton v-if="accountDataLoading" :rows="2" animated />

    <!-- Account metrics -->
    <div v-else-if="accountData" class="account-metrics">
      <el-row :gutter="16">
        <el-col :span="8">
          <el-statistic title="Balance" :value="formattedBalance" :precision="2">
            <template #prefix>$</template>
          </el-statistic>
        </el-col>
        <el-col :span="8">
          <el-statistic title="Equity" :value="formattedEquity" :precision="2">
            <template #prefix>$</template>
          </el-statistic>
        </el-col>
        <el-col :span="8">
          <el-statistic title="Buying Power" :value="formattedBuyingPower" :precision="2">
            <template #prefix>$</template>
          </el-statistic>
        </el-col>
      </el-row>

      <!-- Trading blocked warning -->
      <el-alert
        v-if="accountData.trading_blocked"
        title="Trading Blocked"
        type="error"
        :closable="false"
        show-icon
        class="trading-blocked-alert"
      />
    </div>

    <!-- Empty state - no credential selected -->
    <div v-else class="empty-state">
      <el-text type="info">No account connected</el-text>
    </div>
  </el-card>
</template>

<script setup lang="ts">
import { computed } from 'vue'
import { useAccountStore } from '@/stores/accountStore'

const store = useAccountStore()

// Reactive state from store
const accountData = computed(() => store.accountData)
const accountDataLoading = computed(() => store.accountDataLoading)

// Badge type: warning for paper, danger for live
const accountTypeBadgeType = computed(() => {
  if (!accountData.value) return 'info'
  return accountData.value.account_type === 'paper' ? 'warning' : 'danger'
})

// Format currency values (convert string to number)
const formattedBalance = computed(() => {
  if (!accountData.value) return 0
  return parseFloat(accountData.value.balance)
})

const formattedEquity = computed(() => {
  if (!accountData.value) return 0
  return parseFloat(accountData.value.equity)
})

const formattedBuyingPower = computed(() => {
  if (!accountData.value) return 0
  return parseFloat(accountData.value.buying_power)
})
</script>

<style scoped>
.account-data-display {
  width: 100%;
  min-width: 320px;
}

.card-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0;
}

.header-title {
  font-weight: 600;
  font-size: 14px;
}

.account-type-badge {
  margin-left: auto;
}

.account-metrics {
  padding: 8px 0;
}

.trading-blocked-alert {
  margin-top: 12px;
}

.empty-state {
  text-align: center;
  padding: 16px;
}

/* Override Element Plus statistic styling for compact display */
:deep(.el-statistic__head) {
  font-size: 12px;
  color: var(--el-text-color-secondary);
}

:deep(.el-statistic__content) {
  font-size: 18px;
}
</style>
```

Key design decisions:
- el-badge with type="warning" (orange) for paper, type="danger" (red) for live - clear visual distinction
- el-statistic for formatted currency display with $ prefix
- el-skeleton while loading for smooth UX
- el-alert for trading blocked status (important safety indicator)
- Compact layout suitable for header integration
  </action>
  <verify>
Run: `cd /Users/muzz/Desktop/tac/TOD/apps/orchestrator_3_stream/frontend && npm run build 2>&1 | head -20` and check for no TypeScript/Vue errors
  </verify>
  <done>AccountDataDisplay.vue component exists, compiles without errors, and uses Element Plus components</done>
</task>

<task type="auto">
  <name>Task 2: Integrate AccountDataDisplay into AppHeader</name>
  <files>apps/orchestrator_3_stream/frontend/src/components/AppHeader.vue</files>
  <action>
First, read the existing AppHeader.vue to understand its structure. Then:

1. Add import for AccountDataDisplay:
```typescript
import AccountDataDisplay from '@/components/AccountDataDisplay.vue'
```

2. Add the component in an appropriate location in the header template.
   - Place it in a prominent position (e.g., center or right section of header)
   - Should be visible but not dominate the layout

The exact placement depends on the existing AppHeader structure. Look for:
- A row/flex container where it can be added
- Existing sections for account-related info (like AccountSelector)
- Balance between prominence and not cluttering the header

If AppHeader uses a flex layout, add AccountDataDisplay in a logical position, for example:
```vue
<div class="header-center">
  <AccountDataDisplay />
</div>
```

Or if there's existing account-related section:
```vue
<div class="account-section">
  <AccountSelector /> <!-- existing -->
  <AccountDataDisplay />
</div>
```

Adjust styling as needed to fit the header design. The component is self-contained with its own Card styling.
  </action>
  <verify>
Run: `cd /Users/muzz/Desktop/tac/TOD/apps/orchestrator_3_stream/frontend && npm run build 2>&1 | head -20` and verify no errors. Also: `grep "AccountDataDisplay" src/components/AppHeader.vue`
  </verify>
  <done>AppHeader.vue imports and renders AccountDataDisplay component</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Account data display showing type (paper/live), balance, equity, and buying power in the app header</what-built>
  <how-to-verify>
1. Start backend: `cd /Users/muzz/Desktop/tac/TOD/apps/orchestrator_3_stream && ./start_be.sh`
2. Start frontend: `cd /Users/muzz/Desktop/tac/TOD/apps/orchestrator_3_stream && ./start_fe.sh`
3. Login with a user that has Alpaca credentials
4. Verify the account data display shows:
   - Account type badge (PAPER in orange or LIVE in red)
   - Balance with $ prefix
   - Equity with $ prefix
   - Buying Power with $ prefix
5. Switch credentials if multiple exist - data should update
6. Verify paper accounts show warning (orange) badge
7. Verify loading skeleton shows briefly while fetching
8. If no credential selected, should show "No account connected"
  </how-to-verify>
  <resume-signal>Type "approved" if display works correctly, or describe any issues</resume-signal>
</task>

</tasks>

<verification>
1. Component compiles: `npm run build` passes without errors

2. Component imported in header: `grep -n "AccountDataDisplay" src/components/AppHeader.vue`

3. Visual verification:
   - Account type badge visible (PAPER/LIVE)
   - Badge color: orange for paper, red for live
   - Balance, equity, buying power displayed with $ prefix
   - Loading skeleton during fetch
   - Empty state when no credential
</verification>

<success_criteria>
- AccountDataDisplay.vue component created with Element Plus components
- Component shows account_type badge with correct colors (paper=warning, live=danger)
- Component shows balance, equity, buying_power with $ prefix formatting
- Component shows loading skeleton while accountDataLoading is true
- Component shows "No account connected" when no accountData
- Component shows trading blocked alert if trading_blocked is true
- AppHeader.vue imports and renders AccountDataDisplay
- Visual verification confirms all DISP-01 through DISP-04 requirements met
</success_criteria>

<output>
After completion, create `.planning/phases/05-account-display/05-03-SUMMARY.md`
</output>
