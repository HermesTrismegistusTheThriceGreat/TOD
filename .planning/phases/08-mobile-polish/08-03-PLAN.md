---
phase: 08-mobile-polish
plan: 03
type: execute
wave: 2
depends_on:
  - "08-01"
  - "08-02"
files_modified: []
autonomous: false

must_haves:
  truths:
    - "All pages render correctly at 375px viewport width"
    - "Account selector dropdown fits on screen and is tappable"
    - "Chat interface is usable at mobile viewport"
    - "Mobile hamburger menu works correctly"
    - "WebSocket updates filtered by account ownership (ISO-03)"
  artifacts: []
  key_links: []
---

<objective>
Verify all mobile polish changes work correctly on mobile viewports and test WebSocket account filtering.

Purpose: Validate that all responsive changes from 08-01 and 08-02 work in practice on mobile viewports and confirm ISO-03 requirement.
Output: Verification report confirming mobile responsiveness and WebSocket filtering work correctly.
</objective>

<execution_context>
@/Users/muzz/.claude/get-shit-done/workflows/execute-plan.md
@/Users/muzz/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-mobile-polish/08-RESEARCH.md
@.planning/phases/08-mobile-polish/08-01-SUMMARY.md
@.planning/phases/08-mobile-polish/08-02-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Start dev servers and verify build</name>
  <files></files>
  <action>
1. Ensure the frontend builds without errors:
   ```bash
   cd apps/orchestrator_3_stream/frontend && npm run build
   ```

2. Start the frontend dev server (if not already running):
   ```bash
   cd apps/orchestrator_3_stream && ./start_fe.sh
   ```

3. Wait for dev server to be ready on port 5175.

Document any build errors or warnings that need attention.
  </action>
  <verify>Frontend builds successfully with `npm run build` exit code 0.</verify>
  <done>Dev server is running and frontend builds without errors.</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Mobile-responsive Account Selector, AccountDataDisplay, AppHeader, and Chat components</what-built>
  <how-to-verify>
Use Chrome DevTools to test at mobile viewport:

1. Open http://localhost:5175 in Chrome
2. Open DevTools (Cmd+Option+I / Ctrl+Shift+I)
3. Toggle device toolbar (Cmd+Shift+M / Ctrl+Shift+M)
4. Select "iPhone 12 Pro" (390px) or enter custom 375px width

**Test Account Selector (ACCT-06, MOB-02):**
- [ ] Login to the app
- [ ] Click hamburger menu icon (top right)
- [ ] Verify menu opens and Account Selector is visible
- [ ] Tap Account Selector dropdown
- [ ] Verify dropdown fits on screen (no horizontal overflow)
- [ ] Verify dropdown options are easy to tap (not too small)
- [ ] Select a different account and verify it changes

**Test Chat Interface (MOB-03):**
- [ ] Navigate to /alpaca-agent
- [ ] Verify chat fills the viewport
- [ ] Tap in the input field
- [ ] Verify keyboard appears (simulated) without hiding input
- [ ] Type a test message
- [ ] Verify send button is easy to tap

**Test General Mobile Layout (MOB-01):**
- [ ] Navigate to home page (/)
- [ ] Verify layout stacks vertically (no horizontal scroll)
- [ ] Scroll through the page (should scroll smoothly)
- [ ] Verify all text is readable (not too small)

**Test Navigation:**
- [ ] Hamburger menu opens/closes properly
- [ ] All menu items are tappable
- [ ] Navigation to different views works

Screenshots are helpful but not required.
  </how-to-verify>
  <resume-signal>Type "approved" if all checks pass, or describe issues found</resume-signal>
</task>

<task type="auto">
  <name>Task 3: Verify ISO-03 - WebSocket updates filtered by account</name>
  <files></files>
  <action>
Verify ISO-03 requirement: WebSocket updates are filtered by account ownership.

1. Review the WebSocket implementation in the backend:
   ```bash
   grep -n "credential_id\|account_id\|user_id" apps/orchestrator_3_stream/backend/modules/websocket_manager.py
   ```

2. Check if WebSocket connections are associated with user/account context:
   ```bash
   grep -n "session\|auth\|user" apps/orchestrator_3_stream/backend/main.py | head -20
   ```

3. Document the current state of WebSocket filtering:
   - If WebSocket updates are already filtered by account: Document this as VERIFIED
   - If WebSocket updates are broadcast to all connections: Document this as NEEDS IMPLEMENTATION

The ISO-03 requirement states: "WebSocket updates are filtered by account ownership"

For trading apps, this typically means:
- Position updates only go to the user who owns those positions
- Order updates only go to the user who placed those orders
- Account balance updates only go to the account owner

If the WebSocket is used for general UI events (not trading data), filtering may not be applicable - document this case.
  </action>
  <verify>Documentation of WebSocket filtering status with code references.</verify>
  <done>ISO-03 status documented with evidence from code review.</done>
</task>

</tasks>

<verification>
1. Frontend builds without errors
2. Human verification of mobile UI confirms all checkpoints pass
3. ISO-03 WebSocket filtering is documented (verified or identified as gap)
</verification>

<success_criteria>
- All mobile viewport tests pass at 375px width
- Account selector is touch-friendly and fits viewport
- Chat interface is usable on mobile
- Mobile menu navigation works correctly
- ISO-03 status is documented
- MOB-01, MOB-02, MOB-03, ACCT-06 requirements verified
</success_criteria>

<output>
After completion, create `.planning/phases/08-mobile-polish/08-03-SUMMARY.md` with:
- Mobile verification results
- Screenshots or descriptions of tested scenarios
- ISO-03 status and evidence
- Any issues found and resolutions
</output>
